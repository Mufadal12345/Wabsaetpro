<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØ§Ø¨Ø© Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ± ÙˆØ§Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ù…Ø­Ù„ÙŠ)</title>
    <!-- ØªØ¶Ù…ÙŠÙ† Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }
        /* ØªØ¯Ø±Ø¬ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù‚ Ø§Ù„Ø±Ù…Ù„ÙŠ */
        .main-bg {
            background: linear-gradient(135deg, #1f2937 0%, #171717 100%); /* Deep Zinc/Black-Blue */
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„ØªØµÙ…ÙŠÙ… */
        .section-body-rendered p { margin-bottom: 1rem; }
        .section-body-rendered strong { font-weight: bold; }
        .section-body-rendered ul { list-style: disc; margin-right: 1.5rem; padding-right: 0.5rem; margin-bottom: 1rem;}
        .section-body-rendered .highlight-quote {
            border-right: 4px solid #f59e0b; /* amber-500 */
            background-color: #fffbeb; /* bg-amber-50 */
            padding: 1rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-style: italic;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            color: #1f2937; /* text-gray-800 */
        }
        .editor-textarea { min-height: 150px; }
        .error-flash { transition: opacity 0.5s ease-out; }
    </style>
</head>
<body class="main-bg min-h-screen flex items-center justify-center p-4">

    <!-- ØªÙ… ØªØºÙŠÙŠØ± bg-white Ø¥Ù„Ù‰ bg-stone-100 (Ù„ÙˆÙ† Ø±Ù…Ù„ÙŠ Ù†Ø§Ø¹Ù…) -->
    <div id="app" class="w-full max-w-4xl bg-stone-100 shadow-2xl rounded-xl p-6 md:p-10 transition-all duration-500">
        
        <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¹Ø§Ù…Ø© -->
        <div id="global-error-message" class="hidden fixed top-0 right-0 m-4 p-3 bg-rose-700 text-white rounded-lg shadow-xl z-50 error-flash opacity-0">
            <p id="global-error-text" class="font-semibold"></p>
        </div>

        <!-- Loader / Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ - ØªÙ… ØªØ¨Ø³ÙŠØ·Ù‡ -->
        <div id="loader" class="flex flex-col items-center justify-center h-96 text-gray-700">
            <svg class="animate-spin h-8 w-8 text-blue-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-4 text-lg">Ø¬Ø§Ø±Ù ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­Ù„ÙŠØ©...</p>
        </div>

        <!-- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Registration View) -->
        <div id="registration-view" class="hidden">
            <h1 class="text-3xl font-extrabold text-blue-900 mb-6 text-center">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ±</h1>
            <p class="text-gray-600 mb-8 text-center">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„ØªØ¨Ø¯Ø£ ÙÙŠ Ø§Ø³ØªÙƒØ´Ø§Ù Ø£Ø«Ø±Ùƒ Ø§Ù„ÙÙƒØ±ÙŠ.</p>
            
            <form id="registration-form" class="space-y-6">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700">Ø§Ù„Ø§Ø³Ù…</label>
                    <input type="text" id="name" name="name" required class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-800 focus:border-blue-800 transition duration-150">
                </div>
                
                <div>
                    <label for="specialty" class="block text-sm font-medium text-gray-700">Ø§Ù„ØªØ®ØµØµ</label>
                    <input type="text" id="specialty" name="specialty" required class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-800 focus:border-blue-800 transition duration-150">
                </div>
                
                <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-lg text-lg font-medium text-white bg-blue-800 hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700 transition duration-150">
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù
                </button>
            </form>
            <p id="error-message" class="text-rose-600 text-sm mt-4 text-center hidden"></p>
        </div>

        <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Home View - Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ) -->
        <div id="home-view" class="hidden">
            <div class="flex justify-between items-center mb-8 pb-4 border-b border-gray-300">
                <h1 class="text-3xl font-extrabold text-blue-900">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ <span id="user-display-name">...</span>!</h1>
                <button onclick="window.location.reload();" class="text-sm text-blue-700 hover:text-blue-900 font-medium">
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬/Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
                </button>
            </div>

            <div id="main-menu" class="space-y-3">
                <div class="text-center mb-8 p-4 bg-stone-200 rounded-lg shadow-inner">
                    <h2 class="text-3xl font-extrabold text-blue-900">ğŸ¨âœ¨ Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ±</h2>
                    <p class="text-lg text-gray-600 mt-1">Ø­ÙŠØ« ØªÙˆÙ„Ø¯ Ø§Ù„Ø£ÙÙƒØ§Ø± ÙˆØªØ¨Ù‚Ù‰ Ø®Ø§Ù„Ø¯Ø© âœ¨</p>
                </div>
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù‡Ù†Ø§ -->
                <div id="dynamic-sections-list">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
                </div>
            </div>

            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ -->
            <div id="section-content" class="hidden bg-stone-200 p-6 rounded-lg shadow-inner">
                <h2 id="section-title" class="text-3xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-400"></h2>
                <div id="section-body" class="text-gray-700 leading-relaxed text-lg text-right section-body-rendered"></div>
                <button onclick="globalApp.changeView('main-menu')" class="mt-8 py-2 px-4 bg-blue-800 text-white rounded-lg hover:bg-blue-900 transition duration-150">
                    Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </button>
            </div>
        </div>

        <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ (Management View - Ù„Ù„Ù…Ø¯ÙŠØ±) -->
        <div id="management-view" class="hidden">
            <div class="flex justify-between items-center mb-8 pb-4 border-b border-rose-200">
                <h1 class="text-3xl font-extrabold text-rose-800">ğŸ” Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ)</h1>
                <button onclick="window.location.reload();" class="text-sm text-rose-700 hover:text-rose-900 font-medium">
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                </button>
            </div>
            
            <!-- Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
            <button onclick="globalApp.openEditorModal('new')" class="mb-6 py-2 px-4 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition duration-150 shadow-md">
                + Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ (Ù‚Ø§Ù„Ø¨ Ø¨Ø³ÙŠØ·)
            </button>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ -->
            <div class="space-y-3" id="editable-sections-list">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
            </div>
        </div>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Modal/Form) -->
        <div id="editor-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-stone-100 rounded-xl shadow-2xl w-full max-w-2xl p-6 relative overflow-y-auto max-h-screen">
                <h2 id="editor-title-text" class="text-2xl font-bold text-blue-900 mb-4 border-b pb-2">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…</h2>
                <form id="section-editor-form" class="space-y-4">
                    <input type="hidden" id="editor-doc-id">
                    <input type="hidden" id="editor-type">
                    
                    <div>
                        <label for="editor-menu-title" class="block text-sm font-medium text-gray-700">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù„Ù„Ø§Ø®ØªØµØ§Ø±)</label>
                        <input type="text" id="editor-menu-title" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-700 focus:border-blue-700">
                    </div>

                    <div>
                        <label for="editor-full-title" class="block text-sm font-medium text-gray-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„ (Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø³Ù…)</label>
                        <input type="text" id="editor-full-title" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-700 focus:border-blue-700">
                    </div>
                    
                    <div id="dynamic-editor-fields" class="space-y-4 border p-4 rounded-lg bg-stone-200">
                        <!-- Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© (Ø§Ù„Ù†Øµ Ø§Ù„ØµØ§ÙÙŠ) ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡Ø§ Ù‡Ù†Ø§ -->
                    </div>
                    
                    <div class="flex justify-end space-x-3 space-x-reverse">
                        <button type="button" onclick="globalApp.closeEditorModal()" class="py-2 px-4 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition duration-150">Ø¥Ù„ØºØ§Ø¡</button>
                        <button type="submit" id="editor-save-btn" class="py-2 px-4 bg-blue-800 text-white rounded-lg hover:bg-blue-900 transition duration-150">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                    </div>
                </form>
                
                <p id="modal-error-message" class="text-rose-600 text-sm mt-4 text-center hidden"></p>
            </div>
        </div>
    </div>

    <script>
        // ==========================================================
        //         1. ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        // ==========================================================

        const ADMIN_NAME = 'MUF';
        const ADMIN_SPECIALTY = 'CS';
        const STORAGE_KEY = 'muf_sections_data'; // Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ

        let globalSectionsData = []; // Ø³ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù‡Ù†Ø§ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©

        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ (Template Definitions) - ÙƒÙ…Ø§ ÙƒØ§Ù†Øª ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
        const templates = {
            'basic_highlight': {
                editorFields: [
                    { key: 'p1', label: 'Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠØ©', type: 'textarea' },
                    { key: 'p2', label: 'Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©', type: 'textarea' },
                    { key: 'p3_highlight', label: 'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø¨Ø§Ø±Ø²Ø© ÙˆØ§Ù„Ù…Ù„Ø®ØµØ© (Ø³ØªØ¸Ù‡Ø± Ø¨Ø®Ø· Ø¹Ø±ÙŠØ¶ ÙˆØ¨Ø§Ø±Ø²)', type: 'textarea' },
                    { key: 'p4', label: 'ÙÙ‚Ø±Ø© Ø§Ù„Ø®ØªØ§Ù…', type: 'textarea' }
                ],
                render: (fields) => `
                    <p class="text-xl">${fields.p1}</p>
                    <p class="mt-4">${fields.p2}</p>
                    <p class="mt-4 text-2xl font-extrabold text-blue-900 leading-snug border-b-2 border-amber-500 pb-2">${fields.p3_highlight}</p>
                    <p class="mt-4 text-lg text-amber-600">${fields.p4}</p>
                `
            },
            'list_items': {
                 editorFields: [
                    { key: 'intro', label: 'Ù†Øµ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© (Ù‚Ø¨Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©)', type: 'textarea' },
                    { key: 'listTitle', label: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙØ±Ø¹ÙŠ', type: 'input' },
                    { key: 'listItems', label: 'Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ø¶Ø¹ ÙƒÙ„ Ø¹Ù†ØµØ± ÙÙŠ Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯)', type: 'textarea', placeholder: 'Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø£ÙˆÙ„\nØ§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø«Ø§Ù†ÙŠ\n...' }
                ],
                render: (fields) => {
                    const items = (fields.listItems || '').split('\n').filter(item => item.trim() !== '');
                    const iconList = ['âœï¸', 'ğŸ¨', 'ğŸ’¬', 'ğŸ“š', 'â­', 'ğŸ’', 'ğŸ’¡', 'ğŸ†'];
                    let listHtml = items.map((item, index) => {
                        const icon = iconList[index % iconList.length];
                        return `<li class="flex items-start text-lg"><span class="ml-2 text-2xl text-blue-700">${icon}</span> <span class="font-medium">${item.trim()}</span></li>`;
                    }).join('');

                    return `
                        <p class="text-xl">${fields.intro}</p>
                        <p class="mt-4 font-bold text-lg">${fields.listTitle}</p>
                        <ul class="space-y-3 list-none pr-0">${listHtml}</ul>
                    `;
                }
            },
            'quote_block': {
                editorFields: [
                    { key: 'p1', label: 'Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰', type: 'textarea' },
                    { key: 'p2', label: 'Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (ØªÙ…Ù‡ÙŠØ¯ Ù„Ù„Ø§Ù‚ØªØ¨Ø§Ø³)', type: 'textarea' },
                    { key: 'quote', label: 'Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø¥Ø·Ø§Ø± Ø¨Ø§Ø±Ø²)', type: 'textarea' }
                ],
                render: (fields) => `
                    <p class="text-xl">${fields.p1}</p>
                    <p class="mt-4 text-lg">${fields.p2}</p>
                    <blockquote class="highlight-quote">${fields.quote}</blockquote>
                `
            },
            'final_call': {
                 editorFields: [
                    { key: 'call_title', label: 'Ø¬Ù…Ù„Ø© Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø³ØªØ¸Ù‡Ø± Ø¨Ø®Ø· Ø¹Ø±ÙŠØ¶)', type: 'textarea' },
                    { key: 'call_subtitle', label: 'Ø¬Ù…Ù„Ø© Ø§Ù„ØªØ´Ø¬ÙŠØ¹ (Ø£Ø³ÙÙ„ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)', type: 'textarea' },
                    { key: 'final_signature', label: 'Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø®ØªØ§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', type: 'input' }
                ],
                render: (fields) => `
                    <div class="p-6 bg-blue-100 rounded-xl shadow-lg text-center">
                        <p class="text-3xl font-extrabold mb-4 leading-tight text-blue-900">${fields.call_title}</p>
                        <p class="text-xl font-light italic text-gray-700">${fields.call_subtitle}</p>
                    </div>
                    <p class="mt-8 text-2xl font-extrabold text-blue-900 text-center">ğŸ“ ${fields.final_signature}</p>
                `
            }
        };

        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© (Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© ÙÙ‚Ø·)
        const initialSectionsData = [
            { id: 'sec-1', order: 1, menuTitle: 'ğŸ§­ Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ù‡Ù…ØŸ', title: 'ğŸ§­ Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ù‡Ù…ØŸ', type: 'basic_highlight', 
              fields: { 
                  p1: "ÙÙŠ ÙƒÙ„ Ø·Ø§Ù„Ø¨ØŒ Ù‡Ù†Ø§Ùƒ Ø¹Ø§Ù„Ù… ØºÙŠØ± Ù…ÙƒØªØ´Ù: ÙÙƒØ±Ø© Ø¹Ù…ÙŠÙ‚Ø©ØŒ Ù„ÙˆØ­Ø© Ù„Ù… ØªÙØ¹Ø±Ø¶ØŒ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ù„Ù… ØªØ¬Ø¯ Ù…Ù† ÙŠØ³Ù…Ø¹Ù‡Ø§.", 
                  p2: "Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ± Ù„ÙŠØ³ Ù…Ø´Ø±ÙˆØ¹Ù‹Ø§ Ø¹Ø§Ø¯ÙŠÙ‹Ø§â€¦",
                  p3_highlight: "Ø¥Ù†Ù‡ Ù…Ù†ØµØ© ØªØµÙ†Ø¹ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ø®ØµÙŠ ÙˆØ§Ù„ÙÙƒØ±ÙŠ Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨.",
                  p4: "Ù‡Ù†Ø§ØŒ Ù†ÙØ­ÙˆÙ‘Ù„ Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„ØµØ§Ù…ØªØ© Ø¥Ù„Ù‰ Ø£Ø«Ø± Ø®Ø§Ù„Ø¯ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©."
              }},
            { id: 'sec-2', order: 2, menuTitle: 'ğŸ›ï¸ Ù…Ø§ Ù‡Ùˆ Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ±ØŸ', title: 'ğŸ›ï¸ Ù…Ø§ Ù‡Ùˆ Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ±ØŸ', type: 'list_items',
              fields: { 
                  intro: "Ù‡Ùˆ Ù…Ø³Ø§Ø­Ø© ÙÙƒØ±ÙŠØ© Ø­Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© â€” Ø²Ø§ÙˆÙŠØ© Ø£Ùˆ Ø¬Ø¯Ø§Ø± Ø£Ùˆ Ù‚Ø§Ø¹Ø© â€” ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ø§Ù„ÙÙ„Ø³ÙØ©ØŒ Ø§Ù„ÙÙ†ØŒ ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹.", 
                  listTitle: "Ù…ÙƒØ§Ù† ÙŠÙØ¹Ø¨Ù‘Ø± ÙÙŠÙ‡ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù† Ø°ÙˆØ§ØªÙ‡Ù… Ù…Ù† Ø®Ù„Ø§Ù„:",
                  listItems: "ØªØ£Ù…Ù„Ø§ØªÙ‡Ù… ÙˆØ£ÙÙƒØ§Ø±Ù‡Ù….\nÙ„ÙˆØ­Ø§ØªÙ‡Ù… ÙˆØ±Ø³ÙˆÙ…Ø§ØªÙ‡Ù… Ø§Ù„Ø±Ù…Ø²ÙŠØ©.\nØ§Ù‚ØªØ¨Ø§Ø³Ø§ØªÙ‡Ù… ÙˆÙ…Ù‚Ø§Ù„Ø§ØªÙ‡Ù… Ø§Ù„Ù‚ØµÙŠØ±Ø©.\nØ£Ø³Ø¦Ù„ØªÙ‡Ù… Ø§Ù„ÙˆØ¬ÙˆØ¯ÙŠØ© ÙˆØ±Ø³Ø§Ø¦Ù„Ù‡Ù… Ù„Ù„Ø£Ø¬ÙŠØ§Ù„ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©."
              }},
            { id: 'sec-3', order: 3, menuTitle: 'ğŸ’¡ Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø®ØªÙ„ÙÙ‹Ø§ØŸ', title: 'ğŸ’¡ Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø®ØªÙ„ÙÙ‹Ø§ØŸ', type: 'quote_block',
              fields: { 
                  p1: "Ù„Ø£Ù†Ù‡ ÙŠÙ…Ø³Ù‘ Ø¬ÙˆÙ‡Ø± Ø§Ù„Ø¥Ù†Ø³Ø§Ù†.", 
                  p2: "Ù†Ø­Ù† Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§ØªØŒ Ø¨Ù„ Ù†ÙØ¸Ù‡Ø± Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†Ø§ Ø¨Ø´Ø±Ù‹Ø§: Ø§Ù„ØªÙÙƒÙŠØ±ØŒ Ø§Ù„Ø¥Ø­Ø³Ø§Ø³ØŒ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹.", 
                  quote: "Ø£Ù†Øª Ù„Ø³Øª Ù…Ø¬Ø±Ø¯ Ø±Ù‚Ù… Ø¬Ø§Ù…Ø¹ÙŠØŒ Ø£Ù†Øª ÙÙƒØ±Ø© ØªØ³ØªØ­Ù‚ Ø£Ù† ØªÙØ®Ù„Ù‘Ø¯."
              }},
            { id: 'sec-4', order: 4, menuTitle: 'ğŸŒ¿ Ù…Ø§ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªÙŠ Ø³ÙŠØ¬Ù†ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ†ØŸ', title: 'ğŸŒ¿ Ù…Ø§ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªÙŠ Ø³ÙŠØ¬Ù†ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ†ØŸ', type: 'list_items',
              fields: { 
                  intro: "Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø¯ÙƒØªÙˆØ± ÙŠØ´Ø§Ø±Ùƒâ€¦ Ù‡Ù†Ø§Ùƒ Ù‚ÙŠÙ…Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªØ¹ÙˆØ¯ Ø¥Ù„ÙŠÙ‡:", 
                  listTitle: "Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:",
                  listItems: "Ø§Ù„Ø´Ù‡Ø±Ø© Ø§Ù„ÙÙƒØ±ÙŠØ©: Ø³ÙŠÙƒÙˆÙ† Ø§Ø³Ù…Ùƒ Ù…ÙˆÙ‚Ù‘Ø¹Ù‹Ø§ ÙÙŠ â€œØ¯ÙØªØ± Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„ÙÙƒØ±ÙŠØ©â€ Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¨Ù‚Ù‰ Ù„Ù„Ø£Ø¬ÙŠØ§Ù„.\nØ§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ø£Ø¹Ù…Ø§Ù„Ùƒ: Ù…Ù‚Ø§Ù„ÙƒØŒ Ø±Ø³ÙˆÙ…Ø§ØªÙƒØŒ Ø£Ùˆ Ø£ÙÙƒØ§Ø±Ùƒ Ø³ØªÙƒÙˆÙ† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù…Ø³ÙŠØ±ØªÙƒ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©.\nÙ…Ø¬ØªÙ…Ø¹ ÙÙƒØ±ÙŠ Ø­Ù‚ÙŠÙ‚ÙŠ: ØªÙ„ØªÙ‚ÙŠ Ø¨Ø¹Ù‚ÙˆÙ„ ØªØ´Ø¨Ù‡ÙƒØŒ ØªÙ†Ø§Ù‚Ø´ØŒ ÙˆØªØªØ±Ùƒ Ø£Ø«Ø±Ùƒ ÙÙŠ Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…ÙƒØ§Ù†.\nØªØ¬Ø±Ø¨Ø© Ø¥Ù†Ø³Ø§Ù†ÙŠØ© ÙØ±ÙŠØ¯Ø©: Ø³ØªØ¹ÙˆØ¯ Ø¨Ø¹Ø¯ Ø³Ù†ÙˆØ§Øª Ù„ØªØ¬Ø¯ Ø¢Ø«Ø§Ø±Ùƒ Ø§Ù„ÙÙƒØ±ÙŠØ© Ø¨Ø§Ù‚ÙŠØ©â€¦ ØªØ´Ù‡Ø¯ Ø¹Ù„Ù‰ Ù…Ù† ÙƒÙ†Øª ÙŠÙˆÙ…Ù‹Ø§."
              }},
            { id: 'sec-5', order: 5, menuTitle: 'ğŸš€ Ù„Ù…Ø§Ø°Ø§ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¯Ø¹Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ', title: 'ğŸš€ Ù„Ù…Ø§Ø°Ø§ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¯Ø¹Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ', type: 'quote_block',
              fields: { 
                  p1: "Ù„Ø£Ù†Ùƒ Ø­ÙŠÙ† ØªØ¯Ø¹Ù… Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ±ØŒ ÙØ£Ù†Øª Ù„Ø§ ØªØ¯Ø¹Ù… Ø±ÙƒÙ†Ù‹Ø§ Ø¬Ø§Ù…Ø¹ÙŠÙ‹Ø§â€¦ Ø¨Ù„ ØªØ¯Ø¹Ù… ÙÙƒØ±Ø© Ø£Ù† Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ÙŠØµÙ†Ø¹ Ø£Ø«Ø±Ù‡ Ø¨Ø§Ù„ÙÙƒØ± Ù„Ø§ Ø¨Ø§Ù„Ù…Ø§Ù„.", 
                  p2: "ÙƒÙ„ Ù„ÙˆØ­Ø©ØŒ ÙƒÙ„ Ø§Ù‚ØªØ¨Ø§Ø³ØŒ ÙƒÙ„ Ù…Ø´Ø§Ø±ÙƒØ© â€” Ù‡ÙŠ Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø±ÙˆØ­ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©.",
                  quote: "Ù…Ù† ÙŠØ¯Ø¹Ù… Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„ÙŠÙˆÙ…ØŒ Ø³ÙŠÙØ°ÙƒØ± ØºØ¯Ù‹Ø§ Ø¨Ø£Ù†Ù‡ Ø³Ø§Ù‡Ù… ÙÙŠ Ø¨Ù†Ø§Ø¡ Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„ÙÙƒØ±ÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰."
              }},
            { id: 'sec-6', order: 6, menuTitle: 'ğŸ­ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„ØªÙˆØ³Ù‘Ø¹', title: 'ğŸ­ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„ØªÙˆØ³Ù‘Ø¹', type: 'list_items',
              fields: { 
                  intro: "Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ± Ù„ÙŠØ³ Ù„Ø­Ø¸Ø© Ù…Ø¤Ù‚ØªØ©ØŒ Ø¨Ù„ Ø¨Ø°Ø±Ø© Ù…Ø´Ø±ÙˆØ¹ Ø«Ù‚Ø§ÙÙŠ Ø¯Ø§Ø¦Ù….", 
                  listTitle: "Ù…Ø¹ Ø§Ù„ÙˆÙ‚ØªØŒ Ø³ØªÙ‚Ø§Ù… Ù…Ù† Ø®Ù„Ø§Ù„Ù‡:",
                  listItems: "Ù…Ø¹Ø§Ø±Ø¶ ÙÙƒØ±ÙŠØ© ÙˆÙÙ†ÙŠØ© Ø¯ÙˆØ±ÙŠØ©.\nÙ…Ø³Ø§Ø¨Ù‚Ø§Øª ØªØ­ÙÙŠØ²ÙŠØ© Ù„Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ§Øª.\nÙ†Ø¯ÙˆØ§Øª Ø­ÙˆÙ„ Ø§Ù„ÙÙ„Ø³ÙØ© ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØ§Ù„ÙˆØ¹ÙŠ Ø§Ù„Ø°Ø§ØªÙŠ."
              }},
            { id: 'sec-7', order: 7, menuTitle: 'âœ¨ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©', title: 'âœ¨ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©', type: 'final_call',
              fields: { 
                  call_title: "Ø´Ø§Ø±Ùƒ Ø¨ÙÙƒØ±Ø©ØŒ ÙƒÙ„Ù…Ø©ØŒ Ù„ÙˆØ­Ø©ØŒ Ø£Ùˆ Ø­ØªÙ‰ Ø³Ø¤Ø§Ù„ ÙˆØ¬ÙˆØ¯ÙŠ.", 
                  call_subtitle: "Ø§ØªØ±Ùƒ Ø£Ø«Ø±Ù‹Ø§ ÙŠÙØ´Ø¨Ù‡ÙƒØŒ Ù„Ø£Ù† Ù…Ø§ ØªØ²Ø±Ø¹Ù‡ Ø§Ù„ÙŠÙˆÙ… Ø³ÙŠÙƒÙˆÙ† Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© ØºØ¯Ù‹Ø§.",
                  final_signature: "Ù…ØªØ­Ù Ø§Ù„ÙÙƒØ± â€” Ù„Ø£Ù† Ø§Ù„ÙÙƒØ± Ù‡Ùˆ Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†Ø§ Ø®Ø§Ù„Ø¯ÙŠÙ†."
              }}
        ];
        
        // ÙƒØ§Ø¦Ù† Ø¹Ø§Ù„Ù…ÙŠ Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ù† HTML
        window.globalApp = {};

        // ==========================================================
        //         2. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ (LocalStorage)
        // ==========================================================
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        function loadSectionsData() {
            const storedData = localStorage.getItem(STORAGE_KEY);
            if (storedData) {
                try {
                    globalSectionsData = JSON.parse(storedData);
                    console.log("Sections loaded from localStorage.");
                    return;
                } catch (e) {
                    console.error("Error parsing localStorage data. Using initial data.", e);
                }
            }
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£
            globalSectionsData = initialSectionsData;
            saveSectionsData(); // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©
            console.log("Using initial data and saved to localStorage.");
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function saveSectionsData() {
            try {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ±ØªÙŠØ¨ ØµØ­ÙŠØ­ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
                globalSectionsData.sort((a, b) => a.order - b.order);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(globalSectionsData));
            } catch (e) {
                console.error("Error saving data to localStorage.", e);
                displayError("ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù‚Ø¯ ØªÙƒÙˆÙ† Ø³Ø¹Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ù…Ù…ØªÙ„Ø¦Ø© Ø£Ùˆ ØºÙŠØ± Ù…ØªØ§Ø­Ø©.");
            }
        }

        // ==========================================================
        //         3. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
        // ==========================================================

        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø¹Ø§Ø¦Ù…Ø© (Flash Message)
        function displayError(message) {
            const errorFlash = document.getElementById('global-error-message');
            const errorText = document.getElementById('global-error-text');
            
            errorText.textContent = message;
            errorFlash.classList.remove('hidden');
            setTimeout(() => {
                errorFlash.classList.remove('opacity-0');
                errorFlash.classList.add('opacity-100');
            }, 10); 

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                errorFlash.classList.remove('opacity-100');
                errorFlash.classList.add('opacity-0');
                setTimeout(() => errorFlash.classList.add('hidden'), 500); 
            }, 5000);
        }

        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
        function showView(viewId) {
            const views = ['loader', 'registration-view', 'home-view', 'management-view'];
            views.forEach(id => {
                const view = document.getElementById(id);
                if (view) {
                    view.classList.add('hidden');
                }
            });
            const activeView = document.getElementById(viewId);
            if (activeView) {
                activeView.classList.remove('hidden');
            }
        }

        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = () => {
            loadSectionsData();
            showView('registration-view');
        };

        // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±
        document.getElementById('registration-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value.trim();
            const specialty = document.getElementById('specialty').value.trim();
            const errorMessage = document.getElementById('error-message');
            errorMessage.classList.add('hidden');

            if (!name || !specialty) {
                errorMessage.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØªØ®ØµØµ.';
                errorMessage.classList.remove('hidden');
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±
            if (name === ADMIN_NAME && specialty === ADMIN_SPECIALTY) {
                globalApp.renderEditableSections();
                showView('management-view');
                return;
            }

            // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ
            document.getElementById('user-display-name').textContent = name;
            globalApp.renderHomeView(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
            showView('home-view');
        });

        // ==========================================================
        //         4. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ)
        // ==========================================================

        globalApp.fetchSections = () => {
            // ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
             return globalSectionsData;
        };

        globalApp.renderHomeView = () => {
            const sections = globalApp.fetchSections();
            const listElement = document.getElementById('dynamic-sections-list');
            listElement.innerHTML = '';
            
            sections.forEach(section => {
                const div = document.createElement('div');
                div.className = 'cursor-pointer p-4 bg-blue-100 hover:bg-blue-200 rounded-xl shadow-sm transition duration-200 border-r-4 border-blue-700';
                
                // Ø¬Ù„Ø¨ HTML Ø§Ù„Ù…Ø¹Ø¯Ù‘Ù„
                const bodyHtml = templates[section.type] ? templates[section.type].render(section.fields) : `<p>Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚Ø§Ù„Ø¨ ${section.type}.</p>`;

                div.onclick = () => globalApp.showSection(section.id, section.title, bodyHtml);
                div.innerHTML = `
                    <h3 class="text-xl font-semibold text-blue-900">${section.order}. ${section.menuTitle}</h3>
                    <p class="text-xs text-gray-500 mt-1 truncate">${section.menuTitle.split(' ')[2] || '...'}</p>
                `;
                listElement.appendChild(div);
            });
        };

        globalApp.changeView = (target) => {
            const mainMenu = document.getElementById('main-menu');
            const sectionContent = document.getElementById('section-content');
            
            if (target === 'main-menu') {
                mainMenu.classList.remove('hidden');
                sectionContent.classList.add('hidden');
            }
        };

        globalApp.showSection = (id, title, bodyHtml) => {
            document.getElementById('section-title').textContent = title;
            document.getElementById('section-body').innerHTML = bodyHtml;
            
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('section-content').classList.remove('hidden');
        };

        // ==========================================================
        //          5. ÙˆØ¸Ø§Ø¦Ù ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ù„Ù„Ù…Ø¯ÙŠØ±)
        // ==========================================================

        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
        globalApp.renderEditableSections = () => {
            const sections = globalApp.fetchSections();
            const listElement = document.getElementById('editable-sections-list');
            listElement.innerHTML = '';
            
            sections.forEach(section => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-4 bg-stone-200 hover:bg-stone-300 rounded-lg shadow-sm border-r-4 border-rose-600 transition duration-200';
                div.innerHTML = `
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-rose-800">${section.order}. ${section.menuTitle}</h3>
                        <p class="text-xs text-gray-500">Ø§Ù„Ù‚Ø§Ù„Ø¨: ${section.type}</p>
                    </div>
                    <button onclick="globalApp.openEditorModal('${section.id}')" class="py-1 px-3 bg-rose-700 text-white text-sm rounded-md hover:bg-rose-800 transition ml-2">ØªØ¹Ø¯ÙŠÙ„</button>
                `;
                listElement.appendChild(div);
            });
             if (sections.length === 0) {
                 listElement.innerHTML = '<p class="text-center text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯.</p>';
            }
        };
        
        // ØªÙˆÙ„ÙŠØ¯ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ù„Ø¨
        function generateEditorFields(sectionData) {
            const container = document.getElementById('dynamic-editor-fields');
            container.innerHTML = '';
            const templateType = sectionData.type || 'basic_highlight';
            const template = templates[templateType];
            
            document.getElementById('editor-type').value = templateType;

            if (!template) {
                container.innerHTML = `<p class="text-rose-600">Ø®Ø·Ø£: Ø§Ù„Ù‚Ø§Ù„Ø¨ (${templateType}) ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ….</p>`;
                return;
            }

            template.editorFields.forEach(field => {
                const div = document.createElement('div');
                div.className = 'space-y-1';
                
                let inputElement;
                const fieldId = `editor-field-${field.key}`;

                if (field.type === 'textarea') {
                    inputElement = document.createElement('textarea');
                    inputElement.className = 'editor-textarea mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-700 focus:border-blue-700';
                    inputElement.placeholder = field.placeholder || '';
                } else {
                    inputElement = document.createElement('input');
                    inputElement.type = 'text';
                    inputElement.className = 'mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-700 focus:border-blue-700';
                }
                
                inputElement.id = fieldId;
                inputElement.required = true;
                
                const fieldValue = sectionData.fields ? sectionData.fields[field.key] : '';
                inputElement.value = fieldValue;
                
                const label = document.createElement('label');
                label.htmlFor = fieldId;
                label.className = 'block text-sm font-medium text-gray-700';
                label.textContent = field.label;

                div.appendChild(label);
                div.appendChild(inputElement);
                container.appendChild(div);
            });
        }


        // ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„/Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        globalApp.openEditorModal = (docId) => {
            const modal = document.getElementById('editor-modal');
            const form = document.getElementById('section-editor-form');
            const saveBtn = document.getElementById('editor-save-btn');
            const titleText = document.getElementById('editor-title-text');
            document.getElementById('modal-error-message').classList.add('hidden');
            
            form.reset();
            
            let sectionData = {};
            let isNew = docId === 'new';

            if (isNew) {
                document.getElementById('editor-doc-id').value = '';
                titleText.textContent = 'Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯';
                saveBtn.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ­ÙØ¸';
                // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                sectionData = {
                    type: 'basic_highlight', 
                    menuTitle: 'Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯', 
                    title: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯', 
                    fields: { p1: '', p2: '', p3_highlight: '', p4: '' }
                };
            } else {
                titleText.textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ';
                saveBtn.textContent = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
                document.getElementById('editor-doc-id').value = docId;
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‚Ø³Ù… ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
                sectionData = globalSectionsData.find(sec => sec.id === docId);
                if (!sectionData) {
                    displayError('ÙØ´Ù„ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø³Ù… ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©.');
                    return;
                }
            }

            document.getElementById('editor-menu-title').value = sectionData.menuTitle || '';
            document.getElementById('editor-full-title').value = sectionData.title || '';
            
            generateEditorFields(sectionData);

            modal.classList.remove('hidden');
        };

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        globalApp.closeEditorModal = () => {
            document.getElementById('editor-modal').classList.add('hidden');
        };
        
        // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙˆØ§Ù„ØªØ®Ø²ÙŠÙ†
        document.getElementById('section-editor-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const docId = document.getElementById('editor-doc-id').value;
            const menuTitle = document.getElementById('editor-menu-title').value;
            const fullTitle = document.getElementById('editor-full-title').value;
            const type = document.getElementById('editor-type').value;
            const saveBtn = document.getElementById('editor-save-btn');
            const modalError = document.getElementById('modal-error-message');
            
            saveBtn.disabled = true;
            saveBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
            modalError.classList.add('hidden');
            
            // 1. ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            const newFields = {};
            const template = templates[type];
            template.editorFields.forEach(field => {
                newFields[field.key] = document.getElementById(`editor-field-${field.key}`).value.trim();
            });

            // 2. ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø³Ù…
            const sectionData = {
                menuTitle: menuTitle,
                title: fullTitle,
                type: type,
                fields: newFields
            };

            try {
                if (docId) {
                    // ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯
                    const index = globalSectionsData.findIndex(sec => sec.id === docId);
                    if (index !== -1) {
                        // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© (Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ØªÙŠØ¨ ÙˆØ§Ù„Ù€ ID)
                        globalSectionsData[index] = { 
                            ...globalSectionsData[index], 
                            ...sectionData 
                        };
                    }
                } else {
                    // Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯
                    const newId = 'sec-' + Date.now();
                    const nextOrder = globalSectionsData.length > 0 ? 
                                       Math.max(...globalSectionsData.map(s => s.order)) + 1 : 1;
                    
                    globalSectionsData.push({ 
                        ...sectionData, 
                        id: newId,
                        order: nextOrder 
                    });
                }
                
                // 3. Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
                saveSectionsData();
                globalApp.closeEditorModal();
                globalApp.renderEditableSections(); 
                globalApp.renderHomeView(); 
                console.log("Section saved successfully to localStorage!");

            } catch (error) {
                console.error("Error saving section:", error);
                modalError.textContent = `ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù‚Ø³Ù…. Ø§Ù„Ø®Ø·Ø£: ${error.message}.`;
                modalError.classList.remove('hidden');
            } finally {
                saveBtn.disabled = false;
                saveBtn.textContent = docId ? 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' : 'Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ­ÙØ¸';
            }
        });
    </script>
</body>
</html>